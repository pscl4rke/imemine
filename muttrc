
#                                              vim:ft=muttrc:fdm=marker:
#======================================================================#
#                        MUTT PREFERENCES FILE                         #
#======================================================================#


#     USAGE: This file contains Mutt preferences that are
#       carried across multiple sites.  Place host-specific
#       information in your .muttrc, and then source these
#       preferences with "source ~/.muttrc-prefs".


# NAVIGATION KEY-BINDINGS {{{
#   For some crazy reason the keys in the pager jump around
#   different messages instead of just scrolling up and down.
#   Generally speaking, making this more less-like.
bind pager j next-line
bind pager <down> next-line
bind pager k previous-line
bind pager <up> previous-line
bind generic <left> noop
bind generic <right> noop
bind index,generic G last-entry
bind pager G bottom
bind pager } skip-quoted
bind index,browser,generic <space> next-page
#}}}


# ACTION KEY-BINDINGS {{{
#   These rebind the commands that send messages so they are
#   prefixed by an 'm'.  It frees up the bare keys to be used
#   by things that are more useful to me.
macro index,pager mm "<mail>"
macro index,pager me "<edit>"
macro index,pager mr "<reply>"
macro index,pager mg "<group-reply>"
macro index,pager mf "<forward-message>"
macro index,pager mb "<bounce-message>"
bind index,pager e noop
bind index,pager r noop
bind index,generic g first-entry
bind pager g top
bind index,pager f noop
bind index,pager b noop
#}}}


# SAVING KEY-BINDINGS
#   These apply to the command line 'editor' at the bottom of
#   the screen, which is mostly used when choosing where to
#   save messages and attachments.
#   I disable "buffy-cycle" so that space actually works!!!
bind editor <space> noop


# PIPING MESSAGES INTO STUFF
#   These allow me to send messages into other programs.
#   Note that I will still get a Wait Key prompt if the
#   exit code is non-zero.
#   See http://dev.mutt.org/trac/wiki/MuttGuide/Macros
set wait_key="no"
macro index,pager || "<pipe-message>"
macro index,pager |j "<pipe-message>$HOME/imemine/bin/jerks<enter>"


# FILTERING KEY-BINDINGS {{{
#   By using the tilde as a prefix I can give myself different
#   views on the emails in a folder.
macro index ~~ "<limit>!~D<enter><collapse-all><current-middle>"
macro index ~d "<limit>~D<enter><collapse-all><current-middle>"
macro index ~f "<limit>~F<enter><collapse-all><current-middle>"
macro index ~n "<limit>~N | ~O<enter><collapse-all><current-middle>"
#}}}


# WRITING AND REPLYING {{{
#   Use vim as the editor for emails etc.  And ask it to use tabbed
#   mode, because that should be its default anyway.  I also want
#   to be able to edit the headers as well.
set editor="vim -p"
set forward_format="Fwd: %s"
set edit_headers
#}}}


# RANDOM STUFF
unset help
set menu_scroll="yes"
bind index,pager R imap-fetch-mail


# ENTERING BEHAVIOUR
#   Don't bother asking me whether I want to create ~/Mail
#   every time I launch mutt with the -f option.
set folder="/dev/null"


# EXITING BEHAVIOUR
#   Don't delete anything, but do ask me if I want to leave
#   (because reloading IMAP is particularly slow).
set quit=ask-yes
set delete=no


# VIEWING THE INDEX {{{
#   Here I highlight any unread or flagged messages, and try
#   to ignore deleted ones.
#   Note: these only make sense on a dark background.
color index yellow default ~N
color index yellow default ~O
color index brightgreen default ~F
color index red default ~D
#   I am undecided exactly how I like my index lines to be
#   displayed, so here are some different options.
# Default:
#set index_format="%4C %Z %{%b %d} %-15.15L (%?l?%4l&%4c?) %s"
# With dates on the right:
set index_format="%4C %Z %-15.15L (%?l?%4l&%4c?) %?M?+(%M)&? %s %*  %{%e %b}"
# And the status line:
set status_format=" %f (%P) %> [%?V?%V&all?] (%?V?%M/%L of &?%m/%l)"
#}}}


# THREAD SUPPORT {{{
#   Make use of threads in the index, and give some nice key
#   bindings for them.
#bind index <space> tag-thread
bind index - collapse-thread
bind index _ collapse-all
set sort="threads"
set sort_aux="last-date-received"
#}}}


# VIEWING AN EMAIL {{{
#   Various behavioural tweaks for the pager mode.
set pager_index_lines="8"
set tilde=yes
set pager_stop
#}}}


# WINDOW TITLING
#   Note that these rely on the xtitles patch, which is usually
#   compiled in.
set xterm_set_titles="yes"
# default: Mutt with %?m?%m messages&no messages?%?n? [%n NEW]?
set xterm_title="%m emails in %f"


# COLOURS {{{
#   Here are a bunch of colours that make using Mutt a bit
#   more agreeable than some of the defaults that I've seen.
#   They aren't too dissimilar from the default Tig colourings
#   that I've seen.
# The messages that get displayed below the status bar:
color message default default
color error default default
# This covers the normal email lists (index):
color normal default default
# This is the tree for showing threads:
color tree red default
# This is the cursor which selects messages:
color indicator white green
# These set the quotation levels:
color quoted  blue default
color quoted1 blue default
color quoted2 blue default
color quoted3 blue default
# This fills the rest of the pager when the message has finished:
color tilde brightblack default
# This is the indicator when a line is wrapped
color markers brightblack default
# This is for the mail headers in the pager:
color hdrdefault brightdefault default
# These don't seem to make much difference:
color signature white default
#
# When HTML leeches into the emails:
# (could use brightblack, but doesn't look as good)
# Tags:
color body magenta default "<[^>@]*>"
# Tags split across lines:
color body magenta default "<[[:alpha:]]*[[:space:]]*$"
color body magenta default "<[^>@]*\"[[:space:]]*$"
color body magenta default "^[^<>@]*\" ?>"
# Entities:
color body magenta default "&nbsp;"
#
# For patch emails containing unified diffs:
color body green default "^[+].*"
color body red default "^-.*"
#}}}


