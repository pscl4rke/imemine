#!/usr/bin/python3


import sys

import mutagen


def check(thing_to_check):
    # Test there is no "COMM::\x00\x00\x00" key, or any kind of COMM* key
    yield from check_from_wipe_mp3_junk_script(thing_to_check)


def check_from_wipe_mp3_junk_script(thing_to_check):
    # See imemine/bin/wipe-mp3-junk for a script that cleans up the mp3
    # files but I keep forgetting exists.
    src = mutagen.File(thing_to_check)
    for prefix in ["TXXX", "APIC"]:
        for key in src:
            if key.startswith(prefix):
                yield thing_to_check, "Contains key %r saying %r" % (key, src[key])


def main():
    for thing_to_check in sys.argv[1:]:
        for path, problem in check(thing_to_check):
            print("%s: %s" % (path, problem[:200]))


if __name__ == '__main__':
    main()
