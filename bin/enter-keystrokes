#!/bin/bash
#======================================================================#
# X11 KEYSTROKE INJECTION TOOL                   (c) 2014 P. S. Clarke #
#======================================================================#

# Best used by setting up window manager keybindings

# I use `xmacro` here, but it is possible `xdotool` would
# also work.  Or `xnee`.  Or `xte`.
# At least one of these may have a `--clear-modifiers`
# option to fix the mod keys (avoiding the need for delay).

[ -z "$1" ] && echo "Don't know what to enter" && exit 1

[[ "$1" != +* ]] && echo "Can only support dates" && exit 1

# short delay allows me time to release mod keys
# otherwise doesn't work in GTK text boxes
sleep 0.2

xmacroplay "$DISPLAY" <<EOF
String $(date "$1")
EOF

# For some reason the keybindings get reset after running this, so
# force them back to my preferences.
xmodmap $HOME/.xmodmap.extra

